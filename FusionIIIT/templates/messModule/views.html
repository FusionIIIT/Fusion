
{% load static %}
{#{% block body %}#}
{% block views %}

    {% comment %}The tab menu starts here!{% endcomment %}
    <div class="ui pointing secondary menu">
        <a class="active item" id="menu1">
            Menu 
        </a>

        <a class="item" id="billm">
            Bill
        </a>
<!--
        <a class="item" id="ph">
            Payment History
        </a>
        -->
        <a class="item" id="regm">
            Register for Mess
        </a>
    </div>

    <div class="ui active tab" id="menu1tab">
        <div class="ui vertical segment">
            <table class="ui definition table" style="padding: 8px; padding-left: 8px; padding-right: 8px;">
                <thead>
                <tr>
                    <th></th>
                    <th>Breakfast</th>
                    <th>Lunch</th>
                    <th>Dinner</th>
                </tr>
                </thead>

                <tbody>

                <tr>
                    
                    <td>Monday</td>
                    {% for item in menu %}
                        {% if item.mess_option == messinfo.mess_option %}
                            {% if item.meal_time == 'MB' or item.meal_time == 'ML' or item.meal_time == 'MD' %}

                                {% if item.meal_time == 'MB' %}
                                    <td>{{item.dish}}</td>
                                {% elif item.meal_time == 'ML' %}
                                    <td>{{item.dish}}</td>
                                {% elif item.meal_time == 'MD' %}
                                    <td>{{item.dish}}</td>
                                {% endif %}

                            {% endif %}
                        {% endif %}
                    {% endfor %}

                </tr>

                <tr>
                    
                    <td>Tuesday</td>
                    {% for item in menu %}
                        {% if item.mess_option == messinfo.mess_option %}

                            {% if item.meal_time == 'TB' or item.meal_time == 'TL' or item.meal_time == 'TD' %}
                                
                                {% if item.meal_time == 'TB' %}
                                    <td>{{item.dish}}</td>
                                {% elif item.meal_time == 'TL' %}
                                    <td>{{item.dish}}</td>
                                {% elif item.meal_time == 'TD' %}
                                    <td>{{item.dish}}</td>
                                {% endif %}    

                            {% endif %}
                        {% endif %}
                    {% endfor %}


                </tr>

                <tr>
                    
                    <td>Wednesday</td>
                    {% for item in menu %}
                        {% if item.mess_option == messinfo.mess_option %}
                            {% if item.meal_time == 'WB' or item.meal_time == 'WL' or item.meal_time == 'WD' %}
                        
                                {% if item.meal_time == 'WB' %}
                                    <td>{{item.dish}}</td>
                                {% elif item.meal_time == 'WL' %}
                                    <td>{{item.dish}}</td>
                                {% elif item.meal_time == 'WD' %}
                                    <td>{{item.dish}}</td>
                                {% endif %}

                            {% endif %}
                        {% endif %}
                    {% endfor %}
                </tr>

                <tr>
                    
                    <td>Thursday</td>
                    {% for item in menu %}
                        {% if item.mess_option == messinfo.mess_option %}
                            {% if item.meal_time == 'THB' or item.meal_time == 'THL' or item.meal_time == 'THD' %}

                        
                                {% if item.meal_time == 'THB' %}
                                    <td>{{item.dish}}</td>
                                {% elif item.meal_time == 'THL' %}
                                    <td>{{item.dish}}</td>
                                {% elif item.meal_time == 'THD' %}
                                    <td>{{item.dish}}</td>
                                {% endif %}

                            {% endif %}
                        {% endif %}
                    {% endfor %}
                </tr>

                <tr>
                    

                    <td>Friday</td>
                    {% for item in menu %}
                        {% if item.mess_option == messinfo.mess_option %}
                            {% if item.meal_time == 'FB' or item.meal_time == 'FL' or item.meal_time == 'FD' %}

                                {% if item.meal_time == 'FB' %}
                                    <td>{{item.dish}}</td>
                                {% elif item.meal_time == 'FL' %}
                                    <td>{{item.dish}}</td>
                                {% elif item.meal_time == 'FD' %}
                                    <td>{{item.dish}}</td>
                                {% endif %}

                            {% endif %}
                        {% endif %}
                    {% endfor %}

                </tr>

                <tr>
                   
                    <td>Saturday</td>
                    {% for item in menu %}
                        {% if item.mess_option == messinfo.mess_option %}
                            {% if item.meal_time == 'SB' or item.meal_time == 'SL' or item.meal_time == 'SD' %}

                                {% if item.meal_time == 'SB' %}
                                    <td>{{item.dish}}</td>
                                {% elif item.meal_time == 'SL' %}
                                    <td>{{item.dish}}</td>
                                {% elif item.meal_time == 'SD' %}
                                    <td>{{item.dish}}</td>
                                {% endif %}

                            {% endif %}
                        {% endif %}
                    {% endfor %}

                </tr>

                <tr>
                    
                    <td>Sunday</td>
                    {% for item in menu %}
                        {% if item.mess_option == messinfo.mess_option %}
                            {% if item.meal_time == 'SUB' or item.meal_time == 'SUL' or item.meal_time == 'SUD' %}

                                {% if item.meal_time == 'SUB' %}
                                    <td>{{item.dish}}</td>
                                {% elif item.meal_time == 'SUL' %}
                                    <td>{{item.dish}}</td>
                                {% elif item.meal_time == 'SUD' %}
                                    <td>{{item.dish}}</td>
                                {% endif %}

                            {% endif %}
                        {% endif %}
                    {% endfor %}

                </tr>
                    
                
                </tbody>

            </table>

            <br>
            <div class="ui divider"></div>
            <div class="extra content">
                <!-- TODO add code to direct to a function which renders the template as a pdf file -->
                <form method="post" target="_blank" action="{% url 'mess:MenuPDF' %}">
                    {% csrf_token %}
                <button type="submit" class="ui primary button right floated">
                    <!-- Download -->
                    <i class="ui download icon right floated"></i>
                </button>
                </form>
                <br>
            </div>

        </div>
    </div>

    <div class="ui tab" id="billmtab">
        <div class="ui vertical segment">

            <table class="ui very basic collapsing celled table sortable centered" style="margin: auto;">
                <thead>
                <tr>
                    <th>Month</th>
                    <th>Monthly bill</th>
                    <th>Rebate Count</th>
                    <th>Rebate Amt</th>
                    <th>NonVeg Amt</th>
                    <th>Total</th>
                </tr></thead>
                <tbody>
                {% for stu in monthly_bill %}
                <tr>
                    <td>{{stu.month}} - {{ stu.year }}</td>
                    <td>{{stu.amount}}</td>
                    <td>{{stu.rebate_count}}</td>
                    <td>{{stu.rebate_amount}}</td>
                    <td>{{stu.nonveg_total_bill}}</td>
                    <td>{{stu.total_bill}}</td>
                </tr>
                {% endfor %}
                </tbody>
            </table>

            <br>
            <br>

            <div class="ui divider"></div>

        </div>
    </div>

    <div class="ui tab" id="phtab">
        <table class="ui very basic collapsing celled table sortable" style="margin: auto;">
            <thead>
                <tr>
                    <th>Student</th>
                    <th>Sem</th>
                    <th>Amount</th>
                    <th>Status</th>
                </tr>
            </thead>

            <tbody>
                {% for pay in payments %}
                <tr>
                    <td>
                        <h4 class="ui image header">
                            <img src="{% static 'globals/img/zlatan.jpg' %}" class="ui mini circular image">
                            <div class="content">
                                {{pay.student_id}}
                            </div>
                        </h4>
                    </td>

                    <td>{{pay.sem}}</td>

                    <td>{{pay.amount_paid}}</td>

                    <td><i class="ui large green checkmark icon"></i></td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <br>

        <div class="ui divider"></div>

    </div>

    <div class="ui active tab" id="regmtab">
    <div class="ui vertical segment">

        {% comment %}Form Tag starts here!{% endcomment %}
        <form method="post" action="{% url 'mess:regsubmit' %}">
            {% csrf_token %}
            <div class="ui form" style="padding: 8px; padding-left: 24px; padding-right: 24px;">

                <div class="ui header">
                    Request for change of Central Mess:
                </div>
                {{current_date}}
                <br>

                {% if current_date <= mess_reg.end_reg %}
                <div class="two fields">
                    <div class="field">
                        <strong> Currently registered in {{ messinfo.mess_option }}</strong>
                        <br>
                        <input type="date" id="date" name="date" value="{{mess_reg.end_reg}}" hidden>
                        <br>
                        <label>Choose Mess*</label>
                        <select class="ui search fluid dropdown" name="mess_type" id="mess_type">
                            <option value="mess2">Veg Mess</option>
                            <option value="mess1">Nonveg Mess</option>
                        </select>
                    </div>
                </div>


                {% comment %}
                TODO: Make this Optional!
                {% endcomment %}

                <div class="field">
                    <button class="ui primary button right floated" type="submit" name="submit">
                        Submit
                    </button>
                </div>
                {% else %}
                Registration Timed Out

                {% endif %}
            </div>
        </form>
        {% comment %}Form Tag ends here!{% endcomment %}

        <br>
        <br>
        <div class="ui divider"></div>

    </div>
</div>

{% endblock %}
{#{% endblock %}#}

{% block javascript %}
<script>
  $(document).ready(function() {
        $('#menu1').on('click', function () {
            $(this).addClass('active');
            $('#ph').removeClass('active');
            $('#regm').removeClass('active');
               $('#billm').removeClass('active');
             $('#menu1tab').show();
               $('#billmtab').hide();
                 $('#regmtab').hide();
                   $('#phtab').hide();


        });
    });
    $(document).ready(function() {
        $('#ph').on('click', function () {
            $(this).addClass('active');
            $('#menu1').removeClass('active');
            $('#billm').removeClass('active');
               $('#regm').removeClass('active');
             $('#phtab').show();
               $('#menu1tab').hide();
                 $('#regmtab').hide();
                   $('#billmtab').hide();


        });
    });
      $(document).ready(function() {
        $('#billm').on('click', function () {
            $(this).addClass('active');
            $('#regm').removeClass('active');
            $('#ph').removeClass('active');
               $('#menu1').removeClass('active');
             $('#billmtab').show();
               $('#regmtab').hide();
                 $('#menu1tab').hide();
                   $('#phtab').hide();


        });
    });
        $(document).ready(function() {
        $('#regm').on('click', function () {
            $(this).addClass('active');
            $('#billm').removeClass('active');
            $('#ph').removeClass('active');
               $('#menu1').removeClass('active');
             $('#regmtab').show();
               $('#billmtab').hide();
                 $('#menu1tab').hide();
                   $('#phtab').hide();


        });
    });
</script>

 <script>
  function download(){
            $.ajax({
                type: 'POST',
                url: 'menudownload/',
                dataType: 'json',

                success: function(data) {

                },
                error: function(data, err) {

                }
            });
        return false;
    }

</script>
{% endblock %}