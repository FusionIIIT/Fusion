{% block applyform %}
    {% comment %}The tab menu starts here!{% endcomment %}

    <div class="ui pointing secondary menu">
        <a class="active item" data-tab="assistantship">
            Assistantship Claim Form
        </a>

        <a class="item" data-tab="MTechGraduateSeminarReport">
            MTech Graduate Seminar Report
        </a>

        <a class="item" data-tab="PhDProgressExamination">
            PhD Progress Examination
        </a>
    </div>
    <!-- <script src = "https://code.jquery.com/jquery-1.10.2.js"></script> -->
    <!-- <script src = "https://code.jquery.com/ui/1.10.4/jquery-ui.js"></script> -->
    
    <div class="ui active tab" data-tab="assistantship">
        <div class="ui vertical segment">
            <form method="post" id="new_assistantshipclaim" enctype="multipart/form-data">
            {% csrf_token %}
                {% comment %}The add a new skill Accordian starts here!{% endcomment %}
                <div class="ui form" style="padding: 8px; padding-left: 24px; padding-right: 24px;">
                    <div class="two fields">
                        <div class="three wide field">
                            <label>Year</label>
                            <div class="ui selection dropdown">
                                <input type="hidden" name="year" required/>
                                <i class="dropdown icon"></i>
                                <div class="default text">Select</div>
                                <div class="menu" required>
                                    <div class="item" id = "1" ></div>
                                    <div class="item" id = "2" ></div>
                                </div>
                            </div>
                        </div>


                        <div class="three wide field" style="margin-left:300px">
                            <label>Month</label>
                            <div class="ui selection dropdown" >
                                <input type="hidden" name="month" required>
                                <i class="dropdown icon"></i>
                                <div class="default text">Select</div>
                                <div class="menu">
                                        <div class="item" data-value="January">January</div>
                                        <div class="item" data-value="Febuary">Febuary</div>
                                        <div class="item" data-value="March">March</div>
                                        <div class="item" data-value="April">April</div>
                                        <div class="item" data-value="May">May</div>
                                        <div class="item" data-value="June">June</div>
                                        <div class="item" data-value="July">July</div>
                                        <div class="item" data-value="August">August</div>
                                        <div class="item" data-value="September">September</div>
                                        <div class="item" data-value="October">October</div>
                                        <div class="item" data-value="November">November</div>
                                        <div class="item" data-value="December">December</div>
                                </div>
                            </div>
                        </div>

                    </div>
                    

                    <div class="one fields">
                        <div class="eight wide field">
                            
                            <label for="bank">Bank Account Number</label>
                            <input type="text" name="bank_account" id="bank" oninvalid="InvalidMsg(this);" oninput="InvalidMsg(this)" maxlength="11"  />
                        </div>
                    </div>
                    
                    <div class="two fields">
                        <div class="eight wide field">
                            <label>Thesis Suervisor</label>
                            <input list="dropdown-menu3" name="thesis_supervisor" id="faculty_Search" type="text" />
                                <datalist class="dropdown-menu" id="dropdown-menu3"></datalist>
                        </div>

                        <div class="eight wide field" style="margin-left: 185px">
                            <label>TA Supervisor</label>
                            <input list="dropdown-menu3" name=" ta_supervisor" id="faculty_Search" type="text"/>
                                <datalist class="dropdown-menu" id="dropdown-menu3"></datalist>
                        </div>

                    </div>

                    <div class="eight wide field">
                        <label>Applicability</label>
                        <div class="ui selection dropdown">
                            <input type="hidden" name="applicability" required>
                            <i class="dropdown icon"></i>
                            <div class="default text">Select</div>
                            <div class="menu">
                                    <div class="item" data-value="GATE">GATE</div>
                                    <div class="item" data-value="CEED">CEED</div>
                                    <div class="item" data-value="NET">NET</div>
                            </div>
                        </div>
                    </div> 

                </div>

    
                <div class="field">
                    <button class="ui primary button right floated" type="submit" onclick="validateAssistantship('new_assistantshipclaim',event)" >
                            Submit
                    </button>
                </div>            
                
            </form>
            <br>
            <br>
        </div>
        <br>
        <div class="extra content"></div>
    </div>

    <div class="ui tab" data-tab="MTechGraduateSeminarReport">
        <div class="ui vertical segment">
            <form method="post" id="new_mtechseminarreport" enctype="multipart/form-data">
            {% csrf_token %}
                {% comment %}The add a new skill Accordian starts here!{% endcomment %}
                <div class="ui form" style="padding: 8px; padding-left: 24px; padding-right: 24px;">
                    <div class ="two fields">
                        <div class="field">
                            <label> Theme of Work</label>
                            <input type="text" name="theme_of_work">
                        </div>
                        <div class="field">
                            <label>Date</label>
                            <input type="date" name="date" required>
                        </div>
                    </div>
                        
                        
                    <div class="two fields">
                        <div class="field" >
                            <label>Place</label>
                            <input name="place" type="text" required/>
                        </div>
                            
                        <div class="field">
                            <label>Time</label>
                            <input type="time" name="time" required>                
                        </div> 
                    </div>       
                    <div class="field">
                        <label>Work done till last Semester</label>
                        <textarea rows="2" name="workdone" required /></textarea>
                    </div>
                        
                    <div class="field">
                        <label>Specific contribution in current Semester</label>
                        <textarea rows="2" name="specificcontri" required /></textarea>
                    </div>  

                    <div class="field">
                        <label>Future Plan</label>
                        <textarea rows="2" name="futureplan" required /></textarea>
                    </div>
                        
                    <div class="field">
                        <label>Brief Report</label>
                        <textarea rows="2" name="briefreport" required /></textarea>
                    </div>
                        
                    <div class="two fields">
                        <div class=" field">
                            <label>Publication Submitted</label>
                            <input type="number"  name="publicationsubmitted" value="0" required/>    
                        </div>
                        <div class="field">
                            <label>Publication Accepted</label>
                            <input type="number" name=" publicationaccepted" value="0" required/>                    
                        </div>
                    </div>
    
                    <div class="two fields">
                        <div class="field">
                            <label>Paper Presented</label>
                            <input type="number" name="paperpresented" value="0" required>
                        </div> 
                        <div class="field">
                            <label>Paper Under Review</label>
                            <input type="number" name="paperunderreview" value="0" required>
                        </div> 
                    </div>     
                     <div class="field">
                        <button  class="ui primary button right floated" type="submit" onclick="validateMtech('new_mtechseminarreport',event)">
                            Submit
                        </button>
                    </div>       
                </div>
            </form>
            <br>
            <br>
        </div>
        <br>
        <div class="extra content"></div>
    </div>

    <div class="ui tab" data-tab="PhDProgressExamination">
        <div class="ui vertical segment">
            <form method="post" id="new_phdprogressexamination" enctype="multipart/form-data">
            {% csrf_token %}
                {% comment %}The add a new skill Accordian starts here!{% endcomment %}
                <div class="ui form" style="padding: 8px; padding-left: 24px; padding-right: 24px;">
                    <div class ="field">
                        <div class="field">
                            <label> Theme of Doctoral Work</label>
                            <input type="text" name="theme_of_work">
                        </div>
                    </div>
                    <div class="two fields">
                        <div class="field">
                            <label>Date and Time</label>
                            <input type="datetime-local" name="date" required>
                        </div>
                        <div class="field" >
                            <label>Place</label>
                            <input name="place" type="text" required/>
                        </div>
                    </div>
                               
                    <div class="field">
                        <label>Work done till last Semester</label>
                        <textarea rows="2" name="workdone" required /></textarea>
                    </div>
                        
                    <div class="field">
                        <label>Specific contribution in current Semester</label>
                        <textarea rows="2" name="specificcontri" required /></textarea>
                    </div>  

                    <div class="field">
                        <label>Future Plan</label>
                        <textarea rows="2" name="futureplan" required /></textarea>
                    </div>
                    <div class="field">
                        <label>Attachments (if any)</label>
                        <input class="ui input" id="fileUpload" onchange="return ValidateExtension()" type="file" name="Attachments" accept=".pdf" required></input>
                        <span id="lblError" style="color: red;"></span>
                    </div>
                        
                    
                    <div class=" field">
                        <label>Number of paper submitted</label>
                        <input type="number"  name="papersubmitted" value="0" required/>    
                    </div>
                    <div class="field">
                            <label>Number of paper published/accepted in conference proceedings</label>
                            <input type="number" name=" paperaccepted" value="0" required/>                    
                    </div>
    
                    <div class="field">
                            <label>Number of paper presented in conferences/meetings/workshops</label>
                            <input type="number" name="paperpresented" value="0" required>
                    </div>      
                     <div class="field">
                        <button  class="ui primary button right floated" type="submit" onclick="validatePhD('new_phdprogressexamination',event)">
                            Submit
                        </button>
                    </div>       
                </div>
            </form>
            <br>
            <br>
        </div>
        <br>
        <div class="extra content"></div>
    </div>
    
{% endblock %}

{% block javascript %}

<script>
    
    //setting the year drop down menu
    var d =new Date();
        document.getElementById("1").innerHTML = d.getFullYear()-1;
        var a = d.getFullYear()-1;
        document.getElementById("1").value=a;

        document.getElementById("2").innerHTML = d.getFullYear();
        var b = d.getFullYear() - 1;
        document.getElementById("2").value=b;


    $('#faculty_Search').on('input', function(){
            current_value = $('#faculty_Search').val();
            // console.log("keyup function");
            $.ajax({
                type: 'POST',
                url: '/academic-procedures/faculty_data/',
                data: {
                    'current_value': current_value,
                },
                success: function(response){
                    response = JSON.parse(response);
                    // console.log(response);
                    $('#dropdown-menu3').html('');
                    for(var i=0;i<response.length;i++){
                        // console.log(response[i]);
                        $('#dropdown-menu3').append('<option value="'+response[i]+'">'+response[i]+'</option>');
                    }
                },
                error: function(rs, e){
                    console.log('error');
                },
            });
        });

    
    function ValidateExtension() {
        var allowedFiles = [".doc", ".docx", ".pdf"];
        var fileUpload = document.getElementById("fileUpload");
        var lblError = document.getElementById("lblError");
        var regex = new RegExp("([a-zA-Z0-9\s_\\.\-:])+(" + allowedFiles.join('|') + ")$");
        if (!regex.test(fileUpload.value.toLowerCase())) {
            lblError.innerHTML = "Please upload files having extensions: <b>" + allowedFiles.join(', ') + "</b> only.";
            return false;
        }
        lblError.innerHTML = "";
        return true;
    }
    
    // Function to check letters and numbers
    // function alphanumeric(inputtxt)
    // {
    //    var letterNumber = /^[0-9A-Z]+$/;
    //    if((inputtxt.value.match(letterNumber)))
    //    {
    //     return true;
    //    }
    //   else
    //    {  
    //     return false; 
    //    }
    // }
  

    function validateAssistantship(form,event){
            event.preventDefault();
            var form = document.getElementById(form);
            var i ;
            var message = "" ;
            for(i=0 ; i<form.length ; i++){
                if(form.elements[i].name != "" && form.elements[i].value==="")
                {
                    message = message + "<p><b>Please fill the " + form.elements[i].name + " field.</b></p>" ;
                }
                else if((form.elements[i].name === "bank_account" && form.elements[i].value.length<11))//|| alphanumeric(form.elements[i])
                {
                    message = message +"<p><b>Please fill the valid " + form.elements[i].name + " field.</b></p>";
                }
            }
            var ret = 0 ;
            if (message != ""){
                ret = 1 ;
                $("#errorContent").html(message);
                $(".formErrors").modal("show") ;
            }

            if(ret == 0)
            {
                var formData = new FormData(form);
                console.log(formData);
                form.reset();
                $.ajax({
                    url: '/academic-procedures/ACF/',
                    data: formData,
                    enctype: "multipart/form-data",
                    type: 'POST',
                    contentType: false, // NEEDED, DON'T OMIT THIS (requires jQuery 1.6+)
                    processData: false, // NEEDED, DON'T OMIT THIS
                    // ... Other options like success and etc
                    success: function(response) {
                        response = JSON.parse(response);
                        console.log(response);
                        console.log("here") ;
                        // $("#modalHeader").html(response.status);
                        if (response.status == "success"){
                            $(".succ").modal("show");
                        }
                        else
                        {
                            $("#errorContent").html('<p><b>'+response.message+'</p></b>');
                            $(".formErrors").modal('show');
                        }
                        form.reset();
                    }
                });
            }
            
               

        
        }
    
    function validateMtech(form,event){
        event.preventDefault();
        var form=document.getElementById(form);
        var i;
        var message= "";
        for(i=0;i<form.length-4; i++)
            if(form.elements[i].name != "" && form.elements[i].value==="")
                {
                    message = message + "<p><b>Please fill the " + form.elements[i].name + " field.</b></p>" ;
                }  
        
        var ret1 = 0 ;
        if (message != ""){
                ret1 = 1 ;
                $("#errorContent").html(message);
                $(".formErrors").modal("show") ;
        }
        
        if(ret1 == 0)
            {
                var formData = new FormData(form);
                console.log(formData);
                form.reset();
                $.ajax({
                    url: '/academic-procedures/MTSGF/',
                    data: formData,
                    enctype: "multipart/form-data",
                    type: 'POST',
                    contentType: false, // NEEDED, DON'T OMIT THIS (requires jQuery 1.6+)
                    processData: false, // NEEDED, DON'T OMIT THIS
                    // ... Other options like success and etc
                    success: function(response) {
                        response = JSON.parse(response);
                        console.log(response);
                        console.log("here") ;
                        // $("#modalHeader").html(response.status);
                        if (response.status == "success"){
                            $(".succ").modal("show");
                        }
                        else
                        {
                            $("#errorContent").html('<p><b>'+response.message+'</p></b>');
                            $(".formErrors").modal('show');
                        }
                        form.reset();
                    }
                });
            }


    }
    function validatePhD(form,event){
        event.preventDefault();
        var form=document.getElementById(form);
        var i;
        var message= "";
        for(i=0;i<form.length-3; i++)
            if(form.elements[i].name != "" && form.elements[i].value==="")
                {
                    message = message + "<p><b>Please fill the " + form.elements[i].name + " field.</b></p>" ;
                }  
        
        var ret1 = 0 ;
        if (message != ""){
                ret1 = 1 ;
                $("#errorContent").html(message);
                $(".formErrors").modal("show") ;
        }
        
        if(ret1 == 0)
            {
                var formData = new FormData(form);
                console.log(formData);
                form.reset();
                $.ajax({
                    url: '/academic-procedures/PHDPE/',
                    data: formData,
                    enctype: "multipart/form-data",
                    type: 'POST',
                    contentType: false, // NEEDED, DON'T OMIT THIS (requires jQuery 1.6+)
                    processData: false, // NEEDED, DON'T OMIT THIS
                    // ... Other options like success and etc
                    success: function(response) {
                        response = JSON.parse(response);
                        console.log(response);
                        console.log("here") ;
                        // $("#modalHeader").html(response.status);
                        if (response.status == "success"){
                            $(".succ").modal("show");
                        }
                        else
                        {
                            $("#errorContent").html('<p><b>'+response.message+'</p></b>');
                            $(".formErrors").modal('show');
                        }
                        form.reset();
                    }
                });
            }


    }
</script> 

{% endblock %}
