{% load custom_tags %}
{% block {{hall.hall_id}} %}
    {% for pending_request in pending_guest_room_requests|get_hall_no:hall_id %}
    <div class="ui secondary segment">
        <div class="ui segment">
            <div class="ui container">
              <h2 class="ui center aligned header">Room for {{pending_request.total_guest}} in {{pending_request.hall.hall_id}}</h2>
              <div class="ui grid">
                <div class="16 wide column">
                  <table class="ui celled table">
                    <thead>
                      <tr>
                        <th>Requested By</th>
                        <th>Guest Name</th>
                        <th>Guest Phone</th>
                        <th>Arrival</th>
                        <th>Departure</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>{{pending_request.intender.user.username}}</td>
                        <td>{{pending_request.guest_name}}</td>
                        <td>{{pending_request.guest_phone}}</td>
                        <td>{{pending_request.arrival_date}}</td>
                        <td>{{pending_request.departure_date}}</td>
                      </tr>
                      <tr>
                        <td colspan="5">
                          <div class="ui styled accordion" style="width : 650px">
                            <div class="title">
                              <i class="dropdown icon"></i>
                              Reason
                            </div>
                            <div class="content">
                              <h3 style="color:grey;">Description</h3>
                              <h4 class="transition hidden" style="color:black;">{{pending_request.purpose}}</h4>
                            </div>
                          </div>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
            {% if user in hall_caretaker or user in hall_warden %}
              {% ifequal current_hall pending_request.hall.hall_id %}
              <form method="post" action="{% url 'hostelmanagement:update_guest_room' %}" class="ui form" role="form">
                {% csrf_token %}
                <select class="ui dropdown" name="status">
                  <option selected disabled value="">Status</option>
                  <option value="Accepted">Accepted</option>
                  <option value="Rejected">Rejected</option>
                  <option value="Pending">Pending</option>
                </select>
                <div style="display: flex; justify-content: space-between; align-items: center">
                  <div class="field" style="flex: 1; margin-right: 10px">
                    <label>Room Number</label>
                    <input type="text" name="guest_room_id">
                  </div>
                  <div class="two fields" style="flex: 0 0 auto;">
                    <button class="mini ui basic button" type="submit" value="{{ pending_request.pk }}" name="accept_request" style="margin-top:15%" onclick="return confirm('Are you sure you want to ACCEPT this request?');">Accept</button>
                    <button class="mini ui negative basic button" type="submit" value="{{ pending_request.pk }}" name="reject_request" style="margin-top:15%; margin-left: 10px" onclick="return confirm('Are you sure you want to REJECT this request?');"><svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="20" height="20" viewBox="0 0 24 24" style=" fill:#000;"><path d="M 10 2 L 9 3 L 4 3 L 4 5 L 7 5 L 17 5 L 20 5 L 20 3 L 15 3 L 14 2 L 10 2 z M 5 7 L 5 20 C 5 21.1 5.9 22 7 22 L 17 22 C 18.1 22 19 21.1 19 20 L 19 7 L 5 7 z"></path></svg>Reject</button>
                  </div>
                </div>
              </form>
              {% endifequal %}
            {% endif %}
          </div>
           
            <br>
            </div>
        </div>
    {% endfor %}
{% endblock %}